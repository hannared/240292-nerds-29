const buttonContact = document.querySelector(".button-contact");
const contactPopup = document.querySelector(".modal-contact");
const contactClose = contactPopup.querySelector(".modal-close");
const contactName = contactPopup.querySelector(".contact-user-name");
const contactForm = contactPopup.querySelector(".contact-form");

if (buttonContact) {
    buttonContact.addEventListener("click", function(evt) {
        evt.preventDefault();
        contactPopup.classList.add("modal-show");
        contactName.focus();
    });
}
if (contactClose) {
    contactClose.addEventListener("click", function(evt) {
        evt.preventDefault();
        contactPopup.classList.remove("modal-show");
        contactPopup.classList.remove("modal-error");
    });
}

if (contactForm) {
    contactForm.addEventListener("submit", function(evt) {
        if (!contactName.value) {
            contactName.classList.add("missing-value-error");
            evt.preventDefault();
            contactPopup.classList.remove("modal-error");
            contactPopup.offsetWidth = contactPopup.offsetWidth;
            contactPopup.classList.add("modal-error");
        }
    });
}

window.addEventListener("keydown", function(evt) {
    if (evt.key === "Escape" && contactPopup.classList.contains("modal-show")) {
        evt.preventDefault();
        contactPopup.classList.remove("modal-show");
        contactPopup.classList.remove("modal-error");

        contactName.classList.remove("missing-value-error");
    }
});

function initMap() {
    var map = new google.maps.Map(
        document.getElementById('map'), {
            center: new google.maps.LatLng(59.938883, 30.323546),
            zoom: 18
        })

    var mapPin = {
        position: new google.maps.LatLng(59.938883, 30.323546),
        type: 'info'
    }

    var Icon = {
        info: 'img/map-marker1.png'
    }

    new google.maps.Marker({
        position: mapPin.position,
        icon: Icon[mapPin.type],
        map: map
    })
}

const catalogButtons = document.querySelectorAll(".catalog-item-price-title");
const catalogPopup = document.querySelector(".modal-catalog-item");
if (catalogPopup) {
    const catalogContactClose = catalogPopup.querySelector(".modal-close");

    for (let i = 0; i < catalogButtons.length; i++) {
        const button = catalogButtons[i];

        button.addEventListener("click", function(evt) {
            evt.preventDefault();
            catalogPopup.classList.add("modal-show");
        });
    }

    if (catalogContactClose) {
        catalogContactClose.addEventListener("click", function(evt) {
            evt.preventDefault();
            catalogPopup.classList.remove("modal-show");
        });
    }

}
let slideIndex = 0;

function showSlides() {
    const slides = document.querySelectorAll(".slider-item");
    // slides.length -> 3
    const dots = document.querySelectorAll(".dot");
    // dots.length -> 3

    if (slides.length == 0) {
        return;
    }

    for (let i = 0; i < slides.length; i++) {
        slides[i].classList.remove('current-slider');
    }

    for (let i = 0; i < dots.length; i++) {
        dots[i].classList.remove("current");
    }

    slideIndex++;

    if (slideIndex > slides.length) {
        slideIndex = 1;
    }

    // slideIndex(1) -> 1 - 1 -> 0
    // slideIndex(2) -> 2 - 1 -> 1
    slides[slideIndex - 1].classList.add("current-slider");
    dots[slideIndex - 1].classList.add("current");

    setTimeout(showSlides, 4000); // Change image every 4 seconds
}

showSlides();